import{E as f,G as g,y as p,H as m,A as h}from"./CuVkK9Pu.js";const y="$s";function d(...s){const a=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(a);const[u,r]=s;if(!u||typeof u!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+u);if(r!==void 0&&typeof r!="function")throw new Error("[nuxt] [useState] init must be a function: "+r);const i=y+u,c=f(),l=g(c.payload.state,i);if(l.value===void 0&&r){const o=r();if(p(o))return c.payload.state[i]=o,o;l.value=o}return l}const A=()=>{const s=d("auth_user",()=>null),a=d("auth_token",()=>null),u=h(),r=async(t,e)=>{try{const n=await $fetch(`${u.public.apiBase}/auth/login`,{method:"POST",body:{email:t,password:e}});return n.status==="success"?(s.value=n.data.user,a.value=n.data.token,{success:!0}):{success:!1,message:n.message||"Login failed"}}catch(n){return{success:!1,message:n.data?.message||"An error occurred during login"}}},i=async t=>{try{const e=await $fetch(`${u.public.apiBase}/auth/register`,{method:"POST",body:t});return e.status==="success"?(s.value=e.data.user,a.value=e.data.token,{success:!0}):{success:!1,message:e.message||"Registration failed"}}catch(e){return{success:!1,message:e.data?.message||"An error occurred during registration"}}},c=()=>{s.value=null,a.value=null};return{user:s,token:a,login:r,register:i,logout:c,updateProfile:async t=>{try{const e=await $fetch(`${u.public.apiBase}/auth/profile`,{method:"PUT",headers:{Authorization:a.value},body:t});return e.status==="success"?(s.value=e.data.user,{success:!0,message:e.message}):{success:!1,message:e.message||"Update failed"}}catch(e){return{success:!1,message:e.data?.message||"An error occurred during update"}}},deleteAccount:async()=>{try{const t=await $fetch(`${u.public.apiBase}/auth/delete-account`,{method:"DELETE",headers:{Authorization:a.value}});return t.status==="success"?(c(),{success:!0}):{success:!1,message:t.message||"Deletion failed"}}catch(t){return{success:!1,message:t.data?.message||"An error occurred during deletion"}}},isLoggedIn:m(()=>!!a.value)}};export{A as u};
